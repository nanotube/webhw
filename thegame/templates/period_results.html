{% extends "base.html" %}
{% load tag_extras %}

{% block title %}
Results for Period {{ period.number }} of World: {{ world.name }}
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="/">Home</a> &rsaquo; 
    <a href="{{ period.world.get_absolute_url }}">World</a> &rsaquo; 
    <a href="{{ period.get_absolute_url }}">Period</a> &rsaquo; 
    Period Results
</div>
{% endblock breadcrumbs %}

{% block content %}

{% if user_membership.is_master %}
    <div class="change_view">
        {% block change_view %}
            <a href="{{period.get_absolute_url}}period_results/master/" class="changelink">Master View</a>
        {% endblock change_view %}
    </div>
{% endif %}

{% block edit_element_form %}
{% endblock edit_element_form %}

<h2>Results for Period <span class="name">{{ period.number }}</span> of World <span class="name">{{ world.name }}</span></h2>

<h3>Period <span class="name">{{ period.number }}</span>: <span class="name">{{ period.name }}</span></h3>
<p>{% autoescape off %}{{ period.description }}{% endautoescape %}</p>

<table class="site">
    <tr>
        <th>Username</th>
        {% block first_last_header %}
        {% endblock first_last_header %}
        <th>Bids placed</th>
        <th>Auctions won</th>
        <th>Wealth created</th>
        <th>Mean absolute error</th>
        {% block grade_header %}
            <th>Grade on Wealth</th>
            <th>Grade on Error</th>
        {% endblock grade_header %}
    </tr>
    {% for result in period_result_list %}
        <tr class="{% cycle 'even' 'odd' %}">
            <td>
                {% block user_display %}
                    {% ifequal user.id result.user.id %}
                        {{ result.user.username }}
                    {% else %}
                        [hidden]
                    {% endifequal %}
                {% endblock user_display %}
            </td>
            {% block first_last_display %}
            {% endblock first_last_display %}
            <td>{{ result.bids_placed }}</td>
            <td>{{ result.auctions_won }}</td>
            <td>{{ result.wealth_created|floatformat:2 }}</td>
            <td>{{ result.mean_absolute_error|floatformat:2 }}</td>
            {% block grade_body %}
                <td>{{ result.grade_wealth|floatformat:4 }}</td>
                <td>{{ result.grade_error|floatformat:4 }}</td>
            {% endblock grade_body %}
        </tr>
    {% endfor %}
</table>
<p>
    <ul class="notes">
        <li>Names of users other than you are hidden.</li>
        <li>Default error for auctions you didn't bid on is {{ world.default_nobid_error|floatformat:2 }}.</li>
        <li>Results are linearly rescaled onto the grade range of {{ world.grade_scale_min }}-{{ world.grade_scale_max }}.</li>
    </ul>
</p>

<p><a href="/thegame/userprofile/">[back to user home]</a></p>
{% endblock %}
